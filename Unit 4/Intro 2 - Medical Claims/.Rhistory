claims <- read.csv("ClaimsData.csv")
claims <- read.csv("ClaimsData.csv")
str(claims)
summary(claims)
table(claims$bucket2009)/nrow(claims)
library(caTools)
set.seed(88)
spl <- sample.split(claims$bucket2009,0.6)
claimstrain <- subset(claims[spl == TRUE])
claimstrain <- subset(claims,spl == TRUE)
claimstest <- subset(claims,spl == FALSE)
prop.table(table(claims$diabetes))
prop.table(table(claimstrain$diabetes))
table(claimstest$bucket2009,claims$bucket2008)
table(claimstest$bucket2009,claimstest$bucket2008)
basetable <- table(claimstest$bucket2009,claimstest$bucket2008)
sum(diag(basetable))/sum(basetable)
penaltymatrix <- matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0), byrow=TRUE, nrow = 5)
penaltymatrix
as.matrix(basetable)*penaltymatrix
sum(as.matrix(basetable)*penaltymatrix)
sum(as.matrix(basetable)*penaltymatrix)/nrow(claimstest)
table(claimstest$bucket2009)[1]/nrow(claimstest)
penaltymatrix[,1]*as.matrix(table(claimstest$bucket2009))
sum(penaltymatrix[,1]*as.matrix(table(claimstest$bucket2009)))
sum(penaltymatrix[,1]*as.matrix(table(claimstest$bucket2009)))/nrow(claimstest)
library(rpart)
library(rpart.plot)
claimstree <- rpart(bucket2009~. -reimbursement2009, data=claimstrain,method=class,cp=0.00005)
claimstree <- rpart(bucket2009~. -reimbursement2009, data=claimstrain,method="class",cp=0.00005)
prp(claimstree)
prp(claimstree)
predicttest <- predict(claimstree,newdata=claimstest,type="class")
table(claimstest$bucket2009,predicttest)
sum(diag(predtable))/sum(predtable)
predtable <- table(claimstest$bucket2009,predicttest)
sum(diag(predtable))/sum(predtable)
sum(as.matrix(predtable)*penaltymatrix)/nrow(claimstest)
claimstree <- rpart(bucket2009~. -reimbursement2009, data=claimstrain,method="class",cp=0.00005,parms = list(loss=penaltymatrix))
predicttest <- predict(claimstree,newdata=claimstest,type="class")
predtable <- table(claimstest$bucket2009,predicttest)
sum(diag(predtable))/sum(predtable)
sum(as.matrix(predtable)*penaltymatrix)/nrow(claimstest)
